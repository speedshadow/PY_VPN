<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    
    <title>{% block title %}{{ settings.seo_title|default:'VPN' }}{% endblock %}</title>
    
    <!-- SEO & Meta Tags -->
    <meta name="description" content="{% block meta_description %}{{ settings.seo_description|default:'Best VPN reviews, comparisons and coupons.' }}{% endblock %}">
    {% if settings.seo_keywords %}<meta name="keywords" content="{{ settings.seo_keywords }}">{% endif %}
    <meta name="robots" content="index, follow">
    {% block canonical_url %}<link rel="canonical" href="{{ request.scheme }}://{{ request.get_host }}{{ request.path }}">{% endblock canonical_url %}
    <link rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml?v={{ STATIC_VERSION }}">

    <!-- Open Graph (Facebook, etc.) -->
    <meta property="og:title" content="{% block og_title %}{{ settings.seo_title|default:settings.site_name }}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{{ settings.seo_description|default:'Best VPN reviews, comparisons and coupons.' }}{% endblock %}">
    <meta property="og:url" content="{{ request.build_absolute_uri }}">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="{{ settings.site_name }}">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{% block twitter_title %}{{ settings.seo_title|default:settings.site_name }}{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}{{ settings.seo_description|default:'Best VPN reviews, comparisons and coupons.' }}{% endblock %}">

    {% load static %}
    {% load tz %}
    
    <!-- Favicon -->
    {% if settings.favicon %}
        <link rel="icon" type="image/png" href="{{ settings.favicon.url }}?v={{ STATIC_VERSION }}" />
    {% else %}
        <link rel="icon" type="image/x-icon" href="{% static 'favicon.ico' %}?v={{ STATIC_VERSION }}" />
    {% endif %}

    <!-- Pre-loading fonts woff2 speed (LCP) -->
    <link rel="preload" href="{% static 'fonts/inter-latin-300-normal.woff2' %}?v={{ STATIC_VERSION }}" as="font" type="font/woff2" crossorigin="anonymous">
    <link rel="preload" href="{% static 'fonts/inter-latin-400-normal.woff2' %}?v={{ STATIC_VERSION }}" as="font" type="font/woff2" crossorigin="anonymous">
    <link rel="preload" href="{% static 'fonts/inter-latin-700-normal.woff2' %}?v={{ STATIC_VERSION }}" as="font" type="font/woff2" crossorigin="anonymous">
    <link rel="preload" href="{% static 'img/grid-pattern.svg' %}?v={{ STATIC_VERSION }}" as="image" type="image/svg+xml">

    <!-- Font Awesome (JavaScript Version for optimal performance) -->
    <script defer nonce="{{ request.csp_nonce }}" src="{% static 'vendor/fontawesome/js/all.min.js' %}"></script>

    <!-- Critical CSS Inlined -->
    <style type="text/css" nonce="{{ request.csp_nonce }}">
        @font-face{font-family:'Inter';font-style:normal;font-display:swap;font-weight:300;src:url("{% static 'fonts/inter-latin-300-normal.woff2' %}") format("woff2");}
        @font-face{font-family:'Inter';font-style:normal;font-display:swap;font-weight:400;src:url("{% static 'fonts/inter-latin-400-normal.woff2' %}") format("woff2");}
        @font-face{font-family:'Inter';font-style:normal;font-display:swap;font-weight:700;src:url("{% static 'fonts/inter-latin-700-normal.woff2' %}") format("woff2");}
        html{font-family:Inter,ui-sans-serif,system-ui,sans-serif;line-height:1.5;}
        body{margin:0;line-height:inherit}
        .container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}
        .relative{position:relative}.absolute{position:absolute}.inset-0{inset:0}.z-10{z-index:10}.flex{display:flex}.min-h-\[60vh\]{min-height:60vh}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-center{justify-content:center}.overflow-hidden{overflow:hidden}.bg-gradient-to-br{background-image:linear-gradient(to bottom right,var(--tw-gradient-stops))}.from-blue-900{--tw-gradient-from:#1e3a8a;--tw-gradient-to:rgba(30,58,138,0);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.via-indigo-900{--tw-gradient-to:rgba(30,58,138,0);--tw-gradient-via-position:50%;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-via),var(--tw-gradient-to);--tw-gradient-via:#312e81}.to-purple-900{--tw-gradient-to:#4c1d95}.opacity-30{opacity:.3}.text-center{text-align:center}.px-4{padding-left:1rem;padding-right:1rem}.mb-8{margin-bottom:2rem}.space-y-4>:not([hidden])~:not([hidden]){margin-top:calc(1rem * (1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.inline-flex{display:inline-flex}.gap-2{gap:.5rem}.rounded-full{border-radius:9999px}.border{border-width:1px}.bg-white{background-color:#fff}.bg-white\/10{background-color:hsla(0,0%,100%,.1)}.backdrop-blur-sm{--tw-backdrop-blur:blur(4px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.shadow-sm{box-shadow:0 1px 2px 0 rgba(0,0,0,.05)}.border-white\/20{border-color:hsla(0,0%,100%,.2)}.py-3{padding-top:.75rem;padding-bottom:.75rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.text-sm{font-size:.875rem;line-height:1.25rem}.font-medium{font-weight:500}.text-white\/90{color:hsla(0,0%,100%,.9)}.h1,.h2,.h3,.h4,.h5,.h6{font-size:inherit;font-weight:inherit}.text-5xl{font-size:3rem;line-height:1}.font-black{font-weight:900}.mb-6{margin-bottom:1.5rem}.bg-clip-text{background-clip:text;-webkit-background-clip:text}.text-transparent{color:transparent}.from-white{--tw-gradient-from:#fff;--tw-gradient-to:hsla(0,0%,100%,0);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.via-blue-100{--tw-gradient-to:hsla(0,0%,100%,0);--tw-gradient-via-position:50%;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-via),var(--tw-gradient-to);--tw-gradient-via:#dbeafe}.to-purple-200{--tw-gradient-to:#e9d5ff}.from-blue-400{--tw-gradient-from:#60a5fa;--tw-gradient-to:rgba(96,165,250,0);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.via-purple-400{--tw-gradient-to:rgba(96,165,250,0);--tw-gradient-via-position:50%;--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-via),var(--tw-gradient-to);--tw-gradient-via:#c084fc}.to-pink-400{--tw-gradient-to:#f472b6}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-white\/80{color:hsla(0,0%,100%,.8)}.max-w-4xl{max-width:56rem}.mx-auto{margin-left:auto;margin-right:auto}.font-light{font-weight:300}.leading-relaxed{line-height:1.625}.text-blue-300{color:#93c5fd}
        @media (min-width:768px){.md\:text-7xl{font-size:4.5rem;line-height:1}.md\:text-2xl{font-size:1.5rem;line-height:2rem}}
        @media (min-width:1024px){.lg\:text-8xl{font-size:6rem;line-height:1}}
    </style>
    <!-- Main Stylesheet (deferred) -->
    <link rel="stylesheet" href="{% static 'css/dist/styles.css' %}?v={{ STATIC_VERSION }}" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="{% static 'css/dist/styles.css' %}?v={{ STATIC_VERSION }}"></noscript>

    <!-- CSS Personalized -->
    <style>
        .vpn-progress-bar {
            height: 8px;
            border-radius: 9999px;
            transition: width 0.3s ease;
        }
        .vpn-progress-bar.success { background: #10b981; }
        .vpn-progress-bar.warning { background: #f59e0b; }
        .vpn-progress-bar.error { background: #ef4444; }
        .vpn-progress-bar.default { background: #3b82f6; }
    </style>

    <!-- Internalized JS -->
    {# Custom project-wide scripts #}
    <script nonce="{{ request.csp_nonce }}" defer src="{% static 'js/main.js' %}?v={{ STATIC_VERSION }}"></script>
    <script nonce="{{ request.csp_nonce }}" defer src="{% static 'js/custom_global_scripts.js' %}?v={{ STATIC_VERSION }}"></script>

    {# Vendor Scripts #}
    <script nonce="{{ request.csp_nonce }}" defer src="{% static 'js/vendor/htmx.min.js' %}?v={{ STATIC_VERSION }}"></script>
    <script nonce="{{ request.csp_nonce }}" defer src="{% static 'js/vendor/alpine.min.js' %}?v={{ STATIC_VERSION }}"></script>
    <script nonce="{{ request.csp_nonce }}" defer src="{% static 'js/vendor/lucide.min.js' %}?v={{ STATIC_VERSION }}"></script>

    <!-- JSON-LD for SEO -->
    {% block json_ld %}
    <script nonce="{{ request.csp_nonce }}" defer type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "{{ settings.site_name }}",
      "url": "{{ request.build_absolute_uri|slice:':-1' }}"
    }
    </script>
    {% endblock json_ld %}

    {% block extra_head %}{% endblock %}
</head>
<body>
    <a href="#main-content" class="skip-link sr-only focus:not-sr-only">Pular para o conte√∫do principal</a>
    <div class="{% if request.path == '/' %}bg-transparent{% else %}bg-gray-50{% endif %} min-h-screen flex flex-col font-sans text-gray-800" role="document">
    {% block navbar %}<nav aria-label="Main Navigation" class="sticky top-0 z-50 bg-white shadow-md">{% include 'partials/navbar.html' %}</nav>{% endblock %}

    <div class="flex flex-1 {% if request.path|slice:":11" == '/dashboard/' %}p-4 gap-4{% else %}{% endif %}">
        {% if request.path|slice:":11" == '/dashboard/' %}
            <aside class="w-64 bg-white p-4 space-y-2 shadow-xl overflow-y-auto rounded-xl border border-gray-200" aria-label="Dashboard Navigation">
                {% include 'dashboard/partials/sidebar.html' %}
            </aside>
        {% endif %}
        <main id="main-content" tabindex="-1" aria-label="Main Content" class="flex-1 overflow-y-auto {% if request.path|slice:":11" == '/dashboard/' %}p-6 bg-white rounded-xl shadow-xl border border-gray-200{% else %}p-0{% endif %}">
            {% block content %}
            <main id="main-content" tabindex="-1">{% endblock %}
        </main>
    </div>
    {% block footer %}<footer aria-label="Footer">{% include 'partials/footer.html' %}</footer>{% endblock %}

{% block page_scripts %}{% endblock %}

    <script nonce="{{ request.csp_nonce }}">
      // Ensure Lucide icons are rendered after page load and HTMX swaps.
      document.addEventListener('DOMContentLoaded', () => {
        if (typeof lucide !== 'undefined') {
          lucide.createIcons();
        }
      });
      document.body.addEventListener('htmx:afterSwap', function(event) {
        if (typeof lucide !== 'undefined') {
          lucide.createIcons();
        }
      });
    </script>

    {% include 'prize_wheel/prize_wheel_popup.html' %}
            <script defer src="{% static 'prize_wheel/js/prize_wheel.js' %}?v={% now "U" %}"></script>
    {% include "partials/cookie_banner.html" %}
</body>
</html>
